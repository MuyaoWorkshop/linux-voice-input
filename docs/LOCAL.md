# æœ¬åœ° Whisper æ–¹æ¡ˆ - å®Œæ•´æŒ‡å—

åŸºäº OpenAI Whisper çš„ç¦»çº¿è¯­éŸ³è½¬æ–‡å­—å·¥å…·ï¼Œå®Œå…¨æœ¬åœ°è¿è¡Œï¼Œéšç§ä¿æŠ¤ã€‚

## ç›®å½•

- [æ–¹æ¡ˆç‰¹ç‚¹](#æ–¹æ¡ˆç‰¹ç‚¹)
- [ç³»ç»Ÿè¦æ±‚](#ç³»ç»Ÿè¦æ±‚)
- [å¿«é€Ÿå®‰è£…](#å¿«é€Ÿå®‰è£…)
- [ä½¿ç”¨æ–¹æ³•](#ä½¿ç”¨æ–¹æ³•)
- [å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼](#å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼)
- [æ•…éšœæ’æŸ¥](#æ•…éšœæ’æŸ¥)
- [æ€§èƒ½ä¼˜åŒ–](#æ€§èƒ½ä¼˜åŒ–)

---

## æ–¹æ¡ˆç‰¹ç‚¹

### æ ¸å¿ƒä¼˜åŠ¿

- âœ… **å®Œå…¨ç¦»çº¿** - æ— éœ€ç½‘ç»œè¿æ¥ï¼Œæ•°æ®ä¸ä¸Šä¼ 
- âœ… **éšç§ä¿æŠ¤** - æ‰€æœ‰å¤„ç†åœ¨æœ¬åœ°å®Œæˆ
- âœ… **åŒæ¨¡å¼è¿è¡Œ** - æ™®é€šæ¨¡å¼ / å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼å¯åˆ‡æ¢
- âœ… **æé€Ÿå¯åŠ¨** - å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼ <0.5 ç§’å“åº”
- âœ… **å®æ—¶åé¦ˆ** - å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼æ”¯æŒéŸ³é‡æ¡å’Œå€’è®¡æ—¶
- âœ… **å…è´¹å¼€æº** - æ— APIè´¹ç”¨ï¼Œå®Œå…¨å…è´¹

### è¿è¡Œæ¨¡å¼å¯¹æ¯”

| æ¨¡å¼ | å¯åŠ¨é€Ÿåº¦ | å†…å­˜å ç”¨ | é€‚ç”¨åœºæ™¯ |
|------|---------|---------|---------|
| **æ™®é€šæ¨¡å¼** | 4-5 ç§’ | 0MB å¸¸é©» | å¶å°”ä½¿ç”¨ï¼ˆæ—¥å‡ 1-2 æ¬¡ï¼‰ |
| **å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼** | <0.5 ç§’ ğŸš€ | ~900MB å¸¸é©» | é¢‘ç¹ä½¿ç”¨ï¼ˆæ—¥å‡ 10+ æ¬¡ï¼‰ |

---

## ç³»ç»Ÿè¦æ±‚

### ç¡¬ä»¶è¦æ±‚
- **CPU**: ä»»æ„ x86_64 å¤„ç†å™¨
- **å†…å­˜**: æœ€ä½ 4GBï¼Œæ¨è 8GB+
- **ç£ç›˜**: ~500MB (æ¨¡å‹ + ä¾èµ–)
- **éº¦å…‹é£**: å¯ç”¨çš„éŸ³é¢‘è¾“å…¥è®¾å¤‡

### è½¯ä»¶è¦æ±‚
- **ç³»ç»Ÿ**: Debian 12 / Ubuntu 20.04+ / Arch / Fedora
- **æ¡Œé¢**: GNOME (æ¨è) / KDE / XFCE / i3wm
- **Python**: 3.8+

### æ€§èƒ½è¯´æ˜

**æœ¬æ–¹æ¡ˆåŸºäº CPU è¿è¡Œ**ï¼ˆæ— éœ€ GPUï¼‰ï¼Œæµ‹è¯•ç¯å¢ƒï¼š
- **æœºå‹**: ThinkPad T14, 16GB RAM
- **æ¨¡å‹**: Whisper base
- **é¦–æ¬¡åŠ è½½**: ~3 ç§’
- **è¯†åˆ« 5 ç§’è¯­éŸ³**: ~3-5 ç§’
- **CPU å ç”¨**: 50-70%

---

## å¿«é€Ÿå®‰è£…

### ä½¿ç”¨å®‰è£…è„šæœ¬ï¼ˆæ¨èï¼‰

é¡¹ç›®æä¾›äº†ç»Ÿä¸€çš„å®‰è£…è„šæœ¬ï¼Œæ”¯æŒè‡ªåŠ¨é…ç½®ï¼š

```bash
cd /home/wanps/bin/tools/voice_input
./install.sh
```

**å®‰è£…è„šæœ¬ä¼šè‡ªåŠ¨å®Œæˆï¼š**
1. æ£€æŸ¥ç³»ç»Ÿä¾èµ–ï¼ˆPythonã€xclipã€portaudio ç­‰ï¼‰
2. åˆ›å»ºé¡¹ç›®è™šæ‹Ÿç¯å¢ƒï¼ˆvenv/ï¼‰
3. å®‰è£… Python ä¾èµ–åŒ…
4. ä¸‹è½½ Whisper base æ¨¡å‹ï¼ˆå¦‚æœæœªå­˜åœ¨ï¼‰
5. å¯é€‰ï¼šé…ç½®å®ˆæŠ¤è¿›ç¨‹æœåŠ¡
6. å¯é€‰ï¼šé…ç½® GNOME å¿«æ·é”®

**é€‰é¡¹è¯´æ˜ï¼š**
- é€‰æ‹©æ–¹æ¡ˆæ—¶é€‰ `1) ä»…å®‰è£…æœ¬åœ° Whisper` æˆ– `3) å®‰è£…åŒæ–¹æ¡ˆ`
- å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼å¯é€‰ï¼ˆæ¨èé¢‘ç¹ä½¿ç”¨è€…å¯ç”¨ï¼‰
- å¿«æ·é”®è‡ªåŠ¨é…ç½®ä¸º Super+V

### æ‰‹åŠ¨å®‰è£…

å¦‚æœä½ æƒ³æ‰‹åŠ¨æ§åˆ¶æ¯ä¸€æ­¥ï¼š

#### 1. å®‰è£…ç³»ç»Ÿä¾èµ–

```bash
sudo apt update
sudo apt install -y \
    portaudio19-dev \
    python3-pyaudio \
    xclip \
    pulseaudio-utils \
    ffmpeg
```

#### 2. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ

```bash
cd /home/wanps/bin/tools/voice_input
python3 -m venv venv
source venv/bin/activate
```

#### 3. å®‰è£… Python ä¾èµ–

**æ–¹æ³•ä¸€ï¼šæ­£ç¡®å®‰è£…ï¼ˆæ¨èï¼‰**

å…ˆå®‰è£… CPU ç‰ˆæœ¬çš„ PyTorchï¼š

```bash
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cpu
pip install openai-whisper pyaudio
```

**æ–¹æ³•äºŒï¼šç›´æ¥å®‰è£…**

```bash
pip install openai-whisper pyaudio
```

> å¦‚æœçœ‹åˆ° NVIDIA ç›¸å…³è­¦å‘Šï¼Œä¸ç”¨æ‹…å¿ƒï¼Œæˆ‘ä»¬ä½¿ç”¨ CPU æ¨¡å¼ã€‚

#### 4. ä¸‹è½½æ¨¡å‹

é¦–æ¬¡è¿è¡Œä¼šè‡ªåŠ¨ä¸‹è½½ï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨é¢„ä¸‹è½½ï¼š

```bash
python3 -c "import whisper; whisper.load_model('base')"
```

æ¨¡å‹ä¼šä¸‹è½½åˆ° `~/.cache/whisper/base.pt`ï¼ˆçº¦ 140MBï¼‰

#### 5. è®¾ç½®æƒé™

```bash
chmod +x local/voice_input.py
chmod +x local/voice_input_wrapper.sh
chmod +x local/voice_input_fast.sh
chmod +x local/switch_mode.sh
```

#### 6. é…ç½®å¿«æ·é”®ï¼ˆå¯é€‰ï¼‰

**GNOMEï¼š**

```bash
gsettings set org.gnome.settings-daemon.plugins.media-keys custom-keybindings \
"['/org/gnome/settings-daemon/plugins/media-keys/custom-keybindings/voice-input/']"

gsettings set org.gnome.settings-daemon.plugins.media-keys.custom-keybinding:\
/org/gnome/settings-daemon/plugins/media-keys/custom-keybindings/voice-input/ \
name "è¯­éŸ³è¾“å…¥"

gsettings set org.gnome.settings-daemon.plugins.media-keys.custom-keybinding:\
/org/gnome/settings-daemon/plugins/media-keys/custom-keybindings/voice-input/ \
command "/home/wanps/bin/tools/voice_input/local/voice_input_wrapper.sh"

gsettings set org.gnome.settings-daemon.plugins.media-keys.custom-keybinding:\
/org/gnome/settings-daemon/plugins/media-keys/custom-keybindings/voice-input/ \
binding '<Super>v'
```

**å…¶ä»–æ¡Œé¢ç¯å¢ƒï¼š**
- KDE Plasma: ç³»ç»Ÿè®¾ç½® â†’ å¿«æ·é”® â†’ è‡ªå®šä¹‰å¿«æ·é”®
- XFCE: è®¾ç½® â†’ é”®ç›˜ â†’ åº”ç”¨ç¨‹åºå¿«æ·é”®
- i3wm: ç¼–è¾‘ `~/.config/i3/config`ï¼Œæ·»åŠ ï¼š
  ```
  bindsym $mod+v exec /home/wanps/bin/tools/voice_input/local/voice_input_wrapper.sh
  ```

---

## ä½¿ç”¨æ–¹æ³•

### å‘½ä»¤è¡Œæµ‹è¯•

```bash
cd /home/wanps/bin/tools/voice_input
source venv/bin/activate
./local/voice_input.py
```

**é¢„æœŸè¾“å‡ºï¼š**
```
æ­£åœ¨åŠ è½½ Whisper æ¨¡å‹...
æ¨¡å‹åŠ è½½å®Œæˆ: base

ğŸ¤ å¼€å§‹å½•éŸ³... (è¯´è¯ååœé¡¿2ç§’è‡ªåŠ¨ç»“æŸ)
...........
æ£€æµ‹åˆ°é™éŸ³ï¼Œåœæ­¢å½•éŸ³
å½•éŸ³ç»“æŸ
æ­£åœ¨è¯†åˆ«...
è¯†åˆ«ç»“æœ: ä»Šå¤©å¤©æ°”å¾ˆå¥½

âœ“ å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼Œå¯ä½¿ç”¨ Ctrl+V ç²˜è´´
```

### å¿«æ·é”®ä½¿ç”¨ï¼ˆæ¨èï¼‰

**æ™®é€šæ¨¡å¼ï¼š**
1. æŒ‰ `Super + V`
2. ç­‰å¾… 4-5 ç§’åŠ è½½æ¨¡å‹
3. å¯¹ç€éº¦å…‹é£è¯´è¯ï¼ˆ10ç§’å†…ï¼‰
4. åœé¡¿ 2 ç§’è‡ªåŠ¨ç»“æŸ
5. è¯†åˆ«å®Œæˆï¼Œè‡ªåŠ¨å¤åˆ¶
6. æŒ‰ `Ctrl + V` ç²˜è´´

**å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼ï¼š**
1. æŒ‰ `Super + V`
2. <0.5 ç§’ç«‹å³å¼€å§‹å½•éŸ³ ğŸš€
3. å®æ—¶æ˜¾ç¤ºéŸ³é‡æ¡
4. è¯´è¯ï¼Œåœé¡¿ 2 ç§’è‡ªåŠ¨ç»“æŸ
5. æ˜¾ç¤ºé™éŸ³å€’è®¡æ—¶
6. è¯†åˆ«å®Œæˆï¼Œè‡ªåŠ¨å¤åˆ¶
7. æŒ‰ `Ctrl + V` ç²˜è´´

---

## å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼

### ä»€ä¹ˆæ˜¯å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼ï¼Ÿ

å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼é€šè¿‡åœ¨åå°å¸¸é©»è¿è¡Œï¼Œé¢„åŠ è½½ Whisper æ¨¡å‹ï¼Œå®ç°æé€Ÿå¯åŠ¨ï¼š

- **å¯åŠ¨é€Ÿåº¦**: ä» 4-5 ç§’é™è‡³ <0.5 ç§’
- **å“åº”é€Ÿåº¦**: æå‡ **87.5%**
- **ç”¨æˆ·ä½“éªŒ**: å®æ—¶éŸ³é‡æ¡ + é™éŸ³å€’è®¡æ—¶
- **èµ„æºå ç”¨**: ~900MB å†…å­˜å¸¸é©»ï¼ŒCPU ç©ºé—²æ—¶ä»… 1.6%

### å¯ç”¨å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼

#### æ–¹æ³•ä¸€ï¼šä½¿ç”¨å®‰è£…è„šæœ¬

è¿è¡Œ `./install.sh` æ—¶é€‰æ‹©å¯ç”¨å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼ã€‚

#### æ–¹æ³•äºŒï¼šæ‰‹åŠ¨åˆ‡æ¢

```bash
cd /home/wanps/bin/tools/voice_input/local
./switch_mode.sh daemon
```

**è¾“å‡ºç¤ºä¾‹ï¼š**
```
=== åˆ‡æ¢åˆ°å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼ ===

1. å¯åŠ¨å®ˆæŠ¤è¿›ç¨‹...
   âœ“ å®ˆæŠ¤è¿›ç¨‹å·²å¯åŠ¨
2. æ›´æ–°å¿«æ·é”®é…ç½®...
   âœ“ å¿«æ·é”®å·²æ›´æ–°ä¸ºå®ˆæŠ¤è¿›ç¨‹æ¨¡å¼

=== åˆ‡æ¢å®Œæˆ ===

å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼ç‰¹ç‚¹ï¼š
  âœ“ å¯åŠ¨é€Ÿåº¦æå¿« (<0.5ç§’)
  âœ“ å®æ—¶éŸ³é‡æ¡æ˜¾ç¤º
  âš  å¸¸é©»å†…å­˜ (~900MB)

ç°åœ¨æŒ‰ Super+V è¯•è¯•ï¼Œåº”è¯¥èƒ½ç«‹å³å¼€å§‹å½•éŸ³ï¼
```

### æ¨¡å¼åˆ‡æ¢

```bash
# æŸ¥çœ‹å½“å‰æ¨¡å¼
./switch_mode.sh status

# åˆ‡æ¢åˆ°å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼ï¼ˆå¿«é€Ÿï¼‰
./switch_mode.sh daemon

# åˆ‡æ¢åˆ°æ™®é€šæ¨¡å¼ï¼ˆèŠ‚çœå†…å­˜ï¼‰
./switch_mode.sh normal

# è‡ªåŠ¨åˆ‡æ¢ï¼ˆå®ˆæŠ¤è¿›ç¨‹ â†” æ™®é€šï¼‰
./switch_mode.sh toggle
```

### ç®¡ç†å®ˆæŠ¤è¿›ç¨‹

```bash
# å¯åŠ¨
systemctl --user start voice-input-daemon

# åœæ­¢
systemctl --user stop voice-input-daemon

# é‡å¯
systemctl --user restart voice-input-daemon

# æŸ¥çœ‹çŠ¶æ€
systemctl --user status voice-input-daemon

# æŸ¥çœ‹æ—¥å¿—
journalctl --user -u voice-input-daemon -f

# å¼€æœºè‡ªå¯åŠ¨
systemctl --user enable voice-input-daemon

# ç¦ç”¨å¼€æœºè‡ªå¯åŠ¨
systemctl --user disable voice-input-daemon
```

### èµ„æºå ç”¨è¯¦æƒ…

**å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼ï¼ˆç©ºé—²çŠ¶æ€ï¼‰ï¼š**

| èµ„æº | å ç”¨ | è¯´æ˜ |
|------|------|------|
| **å†…å­˜** | ~900MB | Whisper base æ¨¡å‹ + Python è¿è¡Œæ—¶ |
| **CPU** | ~1.6% | ä½¿ç”¨ select() ä¼˜åŒ–ï¼Œå‡ ä¹å¯å¿½ç•¥ |
| **ç£ç›˜ I/O** | 0 | æ¨¡å‹å¸¸é©»å†…å­˜ï¼Œæ— ç£ç›˜è¯»å†™ |
| **ç½‘ç»œ** | 0 | å®Œå…¨æœ¬åœ°ï¼Œæ— ç½‘ç»œé€šä¿¡ |

**å·¥ä½œçŠ¶æ€ï¼š**
- CPUï¼šå½•éŸ³æ—¶ ~20-30%ï¼Œè¯†åˆ«æ—¶ ~150%ï¼ˆå¤šæ ¸ï¼‰
- å†…å­˜ï¼šå³°å€¼ ~1GB

### æŠ€æœ¯åŸç†

æƒ³æ·±å…¥äº†è§£å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼çš„å®ç°åŸç†ï¼ŸæŸ¥çœ‹æŠ€æœ¯æ–‡æ¡£ï¼š

ğŸ‘‰ **[å®ˆæŠ¤è¿›ç¨‹ä¼˜åŒ–ï¼šä» 4 ç§’åˆ° 0.5 ç§’](DAEMON_OPTIMIZATION.md)**

**æŠ€æœ¯æ–‡æ¡£å†…å®¹ï¼š**
- æ€§èƒ½ç“¶é¢ˆåˆ†æï¼ˆæ¨¡å‹åŠ è½½è€—æ—¶ 3.5 ç§’ï¼‰
- è§£å†³æ–¹æ¡ˆè®¾è®¡ï¼ˆå®ˆæŠ¤è¿›ç¨‹ vs å…¶ä»–æ–¹æ¡ˆï¼‰
- æ¶æ„è®¾è®¡ï¼ˆUnix Socket é€šä¿¡ï¼‰
- å®ç°ç»†èŠ‚ï¼ˆPython + systemdï¼‰
- æ€§èƒ½ä¼˜åŒ–è¿‡ç¨‹ï¼ˆCPU å ç”¨ 10% â†’ 1.6%ï¼‰

---

## æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: æ— æ³•å½•éŸ³

**é”™è¯¯ä¿¡æ¯**:
```
ALSA lib pcm.c:2722:(snd_pcm_open_noupdate) Unknown PCM
```

**è§£å†³æ–¹æ³•**:
```bash
# æ£€æŸ¥éº¦å…‹é£è®¾å¤‡
arecord -l

# æµ‹è¯•å½•éŸ³
arecord -d 5 test.wav
aplay test.wav

# æ£€æŸ¥ PulseAudio
pulseaudio --check
pulseaudio --start
```

### é—®é¢˜ 2: æœªæ‰¾åˆ° xclip

**é”™è¯¯ä¿¡æ¯**:
```
âŒ é”™è¯¯: æœªæ‰¾åˆ° xclip å‘½ä»¤
```

**è§£å†³æ–¹æ³•**:
```bash
sudo apt install xclip
```

### é—®é¢˜ 3: PyAudio ç¼–è¯‘å¤±è´¥

**é”™è¯¯ä¿¡æ¯**:
```
fatal error: portaudio.h: No such file or directory
```

**è§£å†³æ–¹æ³•**:
```bash
sudo apt install portaudio19-dev python3-pyaudio
pip install pyaudio
```

### é—®é¢˜ 4: è¯†åˆ«ä¸å‡†ç¡®

**å¯èƒ½åŸå› å’Œè§£å†³æ–¹æ³•**:

1. **ç¯å¢ƒå™ªéŸ³å¤ªå¤§**
   - åœ¨å®‰é™ç¯å¢ƒä½¿ç”¨
   - ä½¿ç”¨è´¨é‡æ›´å¥½çš„éº¦å…‹é£

2. **è¯´è¯ä¸æ¸…æ™°**
   - è¯´è¯é€Ÿåº¦é€‚ä¸­
   - åå­—æ¸…æ™°

3. **æ¨¡å‹å¤ªå°**
   - ç¼–è¾‘è„šæœ¬ï¼Œä¿®æ”¹æ¨¡å‹ï¼š
     ```python
     model = whisper.load_model("small")  # æˆ– "medium"
     ```
   - æ›´å¤§çš„æ¨¡å‹æ›´å‡†ç¡®ï¼Œä½†æ›´æ…¢

### é—®é¢˜ 5: è¯†åˆ«é€Ÿåº¦å¤ªæ…¢

**ä¼˜åŒ–æ–¹æ³•**:

1. **ä½¿ç”¨æ›´å°çš„æ¨¡å‹**
   ```python
   model = whisper.load_model("tiny")  # æœ€å¿«
   ```

2. **å…³é—­å…¶ä»–å ç”¨ CPU çš„ç¨‹åº**

3. **æ€§èƒ½å¯¹æ¯”**:
   | æ¨¡å‹ | å‡†ç¡®ç‡ | é€Ÿåº¦ (4æ ¸CPU) |
   |------|--------|--------------|
   | tiny | ~80% | 2-3ç§’ |
   | base | ~85% | 4-5ç§’ |
   | small | ~90% | 8-12ç§’ |
   | medium | ~95% | 20-30ç§’ |

### é—®é¢˜ 6: ModuleNotFoundError

**é”™è¯¯ä¿¡æ¯**:
```
ModuleNotFoundError: No module named 'whisper'
```

**è§£å†³æ–¹æ³•**:
```bash
# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
cd /home/wanps/bin/tools/voice_input
source venv/bin/activate

# é‡æ–°å®‰è£…ä¾èµ–
pip install openai-whisper pyaudio
```

### é—®é¢˜ 7: å¿«æ·é”®ä¸å·¥ä½œ

**æ£€æŸ¥æ­¥éª¤**:

1. éªŒè¯è„šæœ¬å¯æ‰§è¡Œ
   ```bash
   ls -l /home/wanps/bin/tools/voice_input/local/voice_input_wrapper.sh
   # åº”è¯¥æœ‰ x æƒé™
   ```

2. æ‰‹åŠ¨è¿è¡ŒåŒ…è£…è„šæœ¬
   ```bash
   /home/wanps/bin/tools/voice_input/local/voice_input_wrapper.sh
   ```

3. æ£€æŸ¥å¿«æ·é”®é…ç½®
   - æ‰“å¼€ **è®¾ç½®** â†’ **é”®ç›˜** â†’ **æŸ¥çœ‹å’Œè‡ªå®šä¹‰å¿«æ·é”®**
   - æŸ¥æ‰¾ "è¯­éŸ³è¾“å…¥"
   - ç¡®è®¤å¿«æ·é”®å’Œå‘½ä»¤è·¯å¾„æ­£ç¡®

### é—®é¢˜ 8: å®ˆæŠ¤è¿›ç¨‹æ— æ³•å¯åŠ¨

**æ£€æŸ¥æ–¹æ³•**:
```bash
# æŸ¥çœ‹çŠ¶æ€
systemctl --user status voice-input-daemon

# æŸ¥çœ‹æ—¥å¿—
journalctl --user -u voice-input-daemon -n 50

# æ£€æŸ¥æœåŠ¡æ–‡ä»¶
cat ~/.config/systemd/user/voice-input-daemon.service

# é‡æ–°åŠ è½½é…ç½®
systemctl --user daemon-reload
systemctl --user restart voice-input-daemon
```

---

## æ€§èƒ½ä¼˜åŒ–

### Whisper æ¨¡å‹é€‰æ‹©

| æ¨¡å‹    | å¤§å°  | å†…å­˜  | é€Ÿåº¦ (CPU) | å‡†ç¡®ç‡ | æ¨èåœºæ™¯          |
|---------|-------|-------|------------|--------|-------------------|
| tiny    | 75MB  | ~1GB  | å¿« (~2s)   | ~75%   | å¿«é€Ÿç¬”è®°          |
| base    | 150MB | ~2GB  | ä¸­ (~4s)   | ~85%   | æ—¥å¸¸ä½¿ç”¨ï¼ˆæ¨èï¼‰  |
| small   | 490MB | ~3GB  | æ…¢ (~10s)  | ~90%   | é‡è¦æ–‡æ¡£          |
| medium  | 1.5GB | ~5GB  | å¾ˆæ…¢ (~30s)| ~95%   | ä¸“ä¸šåœºæ™¯          |
| large   | 3GB   | ~10GB | ææ…¢ (~60s)| ~98%   | ä¸æ¨èï¼ˆCPU å¤ªæ…¢ï¼‰|

### æ€§èƒ½æµ‹è¯•æ•°æ®

æµ‹è¯•ç¯å¢ƒï¼šThinkPad T14 (Intel i5, 16GB RAM)

| è¯­éŸ³é•¿åº¦ | tiny   | base   | small  |
|----------|--------|--------|--------|
| 3 ç§’     | 1.5s   | 2.8s   | 7.2s   |
| 5 ç§’     | 2.1s   | 4.3s   | 10.5s  |
| 10 ç§’    | 3.5s   | 7.8s   | 18.2s  |

### å½•éŸ³å‚æ•°è°ƒæ•´

ç¼–è¾‘ `local/voice_input.py` è°ƒæ•´å‚æ•°ï¼š

```python
# å½•éŸ³æ—¶é•¿ï¼ˆç§’ï¼‰
RECORD_SECONDS = 10

# é™éŸ³æ£€æµ‹é˜ˆå€¼
SILENCE_THRESHOLD = 500

# é‡‡æ ·ç‡
SAMPLE_RATE = 16000
```

---

## å¸è½½

å¦‚æœéœ€è¦å¸è½½æœ¬åœ°æ–¹æ¡ˆï¼š

```bash
# 1. åœæ­¢å®ˆæŠ¤è¿›ç¨‹ï¼ˆå¦‚æœå¯ç”¨ï¼‰
systemctl --user stop voice-input-daemon
systemctl --user disable voice-input-daemon

# 2. åˆ é™¤æœåŠ¡æ–‡ä»¶
rm -f ~/.config/systemd/user/voice-input-daemon.service
systemctl --user daemon-reload

# 3. åˆ é™¤è™šæ‹Ÿç¯å¢ƒå’Œä»£ç 
cd /home/wanps/bin/tools/voice_input
rm -rf venv/
rm -rf local/

# 4. åˆ é™¤æ¨¡å‹ç¼“å­˜ï¼ˆå¯é€‰ï¼‰
rm -rf ~/.cache/whisper/

# 5. åˆ é™¤å¿«æ·é”®ï¼ˆGNOMEï¼‰
# åœ¨è®¾ç½® â†’ é”®ç›˜ä¸­æ‰‹åŠ¨åˆ é™¤ "è¯­éŸ³è¾“å…¥"
```

---

## å¸¸è§é—®é¢˜

### Q: æ”¯æŒè‹±æ–‡è¯†åˆ«å—ï¼Ÿ

**A**: æ”¯æŒï¼Œä¿®æ”¹è„šæœ¬æŒ‡å®šè¯­è¨€ï¼š
```python
result = model.transcribe("audio.wav", language="en")
```

### Q: è¯†åˆ«ç»“æœæ²¡æœ‰æ ‡ç‚¹ç¬¦å·ï¼Ÿ

**A**: æ­£å¸¸ç°è±¡ï¼ŒWhisper ç¦»çº¿æ¨¡å‹ä¸æ”¯æŒè‡ªåŠ¨æ·»åŠ æ ‡ç‚¹ã€‚å¦‚éœ€æ ‡ç‚¹ï¼Œè¯·ä½¿ç”¨è®¯é£äº‘æ–¹æ¡ˆã€‚

### Q: åªèƒ½è¯†åˆ«10ç§’å—ï¼Ÿ

**A**: å½“å‰è®¾è®¡å¦‚æ­¤ï¼Œé¿å…å†…å­˜å ç”¨è¿‡é«˜ã€‚å¦‚éœ€é•¿æ–‡æœ¬ï¼Œè¯·ä½¿ç”¨è®¯é£äº‘æ–¹æ¡ˆï¼ˆæ— æ—¶é•¿é™åˆ¶ï¼‰ã€‚

### Q: å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼å€¼å¾—å—ï¼Ÿ

**A**: å¦‚æœä½ ï¼š
- âœ… æ¯å¤©ä½¿ç”¨ 10+ æ¬¡ â†’ æ¯æœˆèŠ‚çœ 45 åˆ†é’Ÿ
- âœ… å†…å­˜å……è¶³ï¼ˆ16GB+ï¼‰â†’ 900MB å ç”¨å¯å¿½ç•¥
- âœ… è¿½æ±‚ä½“éªŒ â†’ å³æŒ‰å³ç”¨ï¼Œæ€è·¯ä¸è¢«æ‰“æ–­

é‚£ä¹ˆ**éå¸¸å€¼å¾—**ï¼

### Q: å¦‚ä½•ç¡®è®¤å®ˆæŠ¤è¿›ç¨‹æ­£å¸¸å·¥ä½œï¼Ÿ

**A**: æŒ‰ `Super+V` åï¼š
1. å¦‚æœç«‹å³ï¼ˆ<0.5ç§’ï¼‰æ‰“å¼€ç»ˆç«¯ â†’ å®ˆæŠ¤è¿›ç¨‹æ­£å¸¸
2. å¦‚æœç­‰å¾… 4-5 ç§’ â†’ å®ˆæŠ¤è¿›ç¨‹æœªè¿è¡Œï¼Œæ‰§è¡Œ `./switch_mode.sh daemon`

---

## æ”¯æŒ

- **é¡¹ç›®åœ°å€**: https://github.com/MuyaoWorkshop/linux-voice-input
- **é—®é¢˜åé¦ˆ**: https://github.com/MuyaoWorkshop/linux-voice-input/issues
- **å¸¸è§é—®é¢˜**: [FAQ.md](FAQ.md)
- **æŠ€æœ¯æ–‡æ¡£**: [DAEMON_OPTIMIZATION.md](DAEMON_OPTIMIZATION.md)
